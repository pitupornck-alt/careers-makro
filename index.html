<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</title>

  <style>
    :root { --max: 1100px; }
    body { margin:0; font-family: system-ui, -apple-system, "Segoe UI", sans-serif; background:#f6f7fb; color:#111; }
    
    /* === ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ Header ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Logo === */
    header { padding:40px 18px; color:#fff; background: linear-gradient(120deg, #4f46e5, #6366f1); }
    header .wrap { 
      max-width: var(--max); 
      margin:auto; 
      display: flex; /* ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
      align-items: center; 
      gap: 24px; 
    }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡∏π‡∏õ Logo */
    header .logo {
      width: 100px;         /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
      height: 100px;        /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
      object-fit: contain;  /* ‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
      background: #fff;     /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
      border-radius: 16px;  /* ‡∏°‡∏∏‡∏°‡πÇ‡∏Ñ‡πâ‡∏á */
      padding: 12px;        /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏ö */
      box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* ‡πÄ‡∏á‡∏≤ */
      flex-shrink: 0;       /* ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏î‡∏ï‡∏±‡∏ß */
    }

    header .header-text { flex: 1; }
    header h1 { margin:0 0 8px; font-size:40px; line-height: 1.1; }
    header p { margin:0; font-size:18px; opacity:.95; }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (Mobile) */
    @media (max-width: 600px) {
      header .wrap { flex-direction: column; text-align: center; gap: 16px; }
      header h1 { font-size: 32px; }
      header .logo { width: 80px; height: 80px; }
    }
    /* ================================== */

    main { max-width: var(--max); margin:auto; padding:24px 18px 60px; }
    .card { background:#fff; border-radius:16px; padding:18px; box-shadow:0 10px 28px rgba(0,0,0,.08); margin-bottom:16px; }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .pill { background:#eef2ff; color:#3730a3; font-weight:700; font-size:13px; padding:6px 12px; border-radius:999px; }
    .muted { opacity:.7; }

    input, select { padding:10px 12px; border-radius:12px; border:1px solid rgba(0,0,0,.15); font-size:14px; background:#fff; }
    .btn { border:0; border-radius:12px; padding:10px 16px; font-weight:700; cursor:pointer; }
    .btn.primary { background:#111827; color:#fff; }
    .btn.ghost { background:#eef2ff; color:#3730a3; }

    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:12px; margin-top:12px; }
    .job { border:1px solid rgba(0,0,0,.1); border-radius:14px; padding:16px; background:#fff; transition: transform 0.2s; }
    .job:hover { transform: translateY(-2px); border-color: #4f46e5; }
    .job h3 { margin:0 0 10px; font-size:18px; line-height:1.4; color: #111827; }
    .meta { font-size:13px; opacity:.9; color: #4b5563; }
    .meta div { margin:4px 0; display:flex; align-items:center; gap:6px; }
    
    .status-badge { display:inline-block; font-size:11px; padding:2px 8px; border-radius:4px; font-weight:bold; }
    .status-open { background:#dcfce7; color:#166534; } /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
    .status-closed { background:#fee2e2; color:#991b1b; } /* ‡πÅ‡∏î‡∏á */

    iframe { width:100%; height:800px; border:0; border-radius:16px; background:#fff; margin-top:12px; }
    
    /* Loading Spinner */
    .loader { border: 4px solid #f3f3f3; border-top: 4px solid #4f46e5; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <!-- Logo ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏ú‡πà‡∏≤‡∏ô JavaScript (‡∏î‡∏π‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô CONFIG ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á) -->
    <img id="companyLogo" src="" class="logo" alt="Company Logo" onerror="this.style.display='none'">
    
    <div class="header-text">
      <h1>‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h1>
      <p>‡∏î‡∏π‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ß‡πà‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</p>
    </div>
  </div>
</header>

<main>
  <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
  <section class="card">
    <div class="row" style="justify-content:space-between">
      <div>
        <span class="pill">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô</span>
        <div class="muted" style="margin-top:4px; font-size:14px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</div>
      </div>
      <button class="btn primary" id="refreshBtn">üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>

    <div class="row" style="margin-top:16px">
      <input id="q" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á..." style="flex:1;min-width:200px">
      <select id="filterBranch" style="min-width:150px"><option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤</option></select>
      <button class="btn ghost" id="clearBtn">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
    </div>
  </section>

  <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
  <section class="card">
    <div id="statusMsg" class="muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
    <div id="jobs" class="grid"></div>
  </section>

  <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ -->
  <section class="card" id="applySection" style="display:none;">
    <span class="pill">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</span>
    <p class="muted" style="margin-top:8px">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: <b id="applyPositionName">...</b></p>
    <!-- Microsoft Forms iframe ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    <div id="iframeContainer"></div>
  </section>
</main>

<script>
/* ================= CONFIG (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ================= */

// 1. ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå CSV ‡∏à‡∏≤‡∏Å Google Sheet ‡∏ó‡∏µ‡πà‡∏ó‡∏≥ Publish to Web ‡πÅ‡∏•‡πâ‡∏ß
const GOOGLE_SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRNspwvCPUWv4QOCeQNiC30GdqHfOkPfKjCpy-aeE8lXx0jn2zRnGEbiQfoBWcEb5JBg4R6parrFJUr/pub?output=csv"; 

// 2. ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û Logo (‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Direct Link ‡πÅ‡∏•‡πâ‡∏ß)
const COMPANY_LOGO_URL = "https://drive.google.com/uc?export=view&id=1pqQfRUheY7IKegoQ1rk_bOxycMWGO6Em";

// 3. Microsoft Form Link (‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô)
const FORM_BASE_URL = "https://forms.office.com/r/wabJfczd4Z";

// =========================================================

/* ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Global ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
let allJobs = [];
let branches = new Set();

/* DOM Elements */
const elQ = document.getElementById("q");
const elFilterBranch = document.getElementById("filterBranch");
const elClearBtn = document.getElementById("clearBtn");
const elStatus = document.getElementById("statusMsg");
const elJobs = document.getElementById("jobs");
const elRefreshBtn = document.getElementById("refreshBtn");
const elApplySection = document.getElementById("applySection");
const elApplyPositionName = document.getElementById("applyPositionName");
const elIframeContainer = document.getElementById("iframeContainer");

/* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö */
window.onload = init;

async function init() {
  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Logo
  if (COMPANY_LOGO_URL) {
    document.getElementById("companyLogo").src = COMPANY_LOGO_URL;
  }

  await loadData();
  
  // Event Listeners
  elQ.addEventListener("input", renderJobs);
  elFilterBranch.addEventListener("change", renderJobs);
  elClearBtn.addEventListener("click", () => {
    elQ.value = "";
    elFilterBranch.value = "";
    renderJobs();
  });
  elRefreshBtn.addEventListener("click", loadData);
}

/* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets */
async function loadData() {
  elStatus.innerHTML = '<div class="loader"></div>';
  elJobs.innerHTML = "";
  
  try {
    // ‡πÉ‡∏ä‡πâ fetch ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å URL
    const response = await fetch(GOOGLE_SHEET_CSV_URL);
    
    if (!response.ok) throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
    
    const text = await response.text();
    const data = parseCSV(text); // ‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô Array

    // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Global (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≤‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    // CSV ‡πÄ‡∏Å‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: Code, Branch, Position, Status, Description
    allJobs = data.map(row => ({
      code: row[0] || "",
      branch: row[1] || "",
      position: row[2] || "",
      status: row[3] || "Closed",
      desc: row[4] || ""
    })).filter(job => job.position && job.branch); // ‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏¥‡πâ‡∏á

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤ (Dropdown)
    updateBranchDropdown();
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    renderJobs();
    elStatus.textContent = `‡∏û‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ß‡πà‡∏≤‡∏á ${allJobs.length} ‡∏≠‡∏±‡∏ï‡∏£‡∏≤ (‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleTimeString('th-TH')})`;

  } catch (error) {
    console.error(error);
    elStatus.innerHTML = `<span style="color:red">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message} <br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå Google Sheet CSV</span>`;
  }
}

/* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏á‡∏≤‡∏ô */
function renderJobs() {
  const searchText = elQ.value.toLowerCase();
  const branchFilter = elFilterBranch.value;

  // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  const filtered = allJobs.filter(job => {
    const matchSearch = job.position.toLowerCase().includes(searchText) || 
                        job.branch.toLowerCase().includes(searchText);
    const matchBranch = branchFilter === "" || job.branch === branchFilter;
    const matchStatus = job.status.toLowerCase().trim() === "open"; // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Open

    return matchSearch && matchBranch && matchStatus;
  });

  elJobs.innerHTML = "";

  if (filtered.length === 0) {
    elJobs.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:20px;opacity:0.6">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</div>`;
    return;
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏ó‡∏µ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πå‡∏î
  filtered.forEach(job => {
    const card = document.createElement("div");
    card.className = "job";
    card.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:start;">
        <span class="status-badge status-open">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</span>
        <small class="muted">#${job.code}</small>
      </div>
      <h3>${job.position}</h3>
      <div class="meta">
        <div>üè¢ ‡∏™‡∏≤‡∏Ç‡∏≤: <strong>${job.branch}</strong></div>
        <div>üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${job.desc || '-'}</div>
      </div>
      <button class="btn ghost" style="width:100%; margin-top:12px;" onclick="openApplyForm('${job.position}', '${job.branch}')">
        ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ô‡∏µ‡πâ üëâ
      </button>
    `;
    elJobs.appendChild(card);
  });
}

/* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô */
window.openApplyForm = function(position, branch) {
  elApplySection.style.display = "block";
  elApplyPositionName.textContent = `${position} (${branch})`;
  
  // Scroll ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ü‡∏≠‡∏£‡πå‡∏°
  elApplySection.scrollIntoView({ behavior: "smooth" });

  const finalUrl = FORM_BASE_URL; 
  
  // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î iframe
  elIframeContainer.innerHTML = `<iframe src="${finalUrl}" allowfullscreen></iframe>`;
}

/* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dropdown ‡∏™‡∏≤‡∏Ç‡∏≤ */
function updateBranchDropdown() {
  const branches = [...new Set(allJobs.map(j => j.branch))].sort();
  // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏ß‡πâ
  const currentVal = elFilterBranch.value;
  
  elFilterBranch.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤</option>';
  branches.forEach(b => {
    const opt = document.createElement("option");
    opt.value = b;
    opt.textContent = b;
    elFilterBranch.appendChild(opt);
  });
  
  // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
  if (branches.includes(currentVal)) elFilterBranch.value = currentVal;
}

/* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á CSV ‡πÄ‡∏õ‡πá‡∏ô Array (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Google Sheets) */
function parseCSV(text) {
  const lines = text.split(/\r?\n/);
  const result = [];
  
  for (let i = 1; i < lines.length; i++) { // ‡∏Ç‡πâ‡∏≤‡∏° Header ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å (i=1)
    if (!lines[i].trim()) continue;
    
    const row = lines[i].match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
    
    // ‡∏ñ‡πâ‡∏≤ regex ‡∏û‡∏•‡∏≤‡∏î (‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏¢‡∏≤‡∏ß‡πÜ) ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ split ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÅ‡∏ó‡∏ô
    const fallbackRow = lines[i].split(',');
    
    // ‡∏Ñ‡∏•‡∏µ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏•‡∏ö Quote)
    const cleanRow = (row || fallbackRow).map(col => 
      col.replace(/^"|"$/g, '').replace(/""/g, '"').trim()
    );
    
    result.push(cleanRow);
  }
  return result;
}
</script>

</body>
</html>
